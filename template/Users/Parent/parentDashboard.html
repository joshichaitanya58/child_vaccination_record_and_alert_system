<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parent Dashboard - Child Vaccination System</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="{{ url_for('static', filename='images/favicon.ico') }}" type="image/x-icon">
    <!-- Include Chart.js for Growth Charts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- FullCalendar JS -->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js'></script>
    <!-- Leaflet CSS for Map View -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <link rel="stylesheet" href="{{ url_for('static', filename='CSS/Users/Parent/parentDashboard.css') }}">

</head>

<body class="text-gray-800 bg-gradient-to-br from-blue-50 to-indigo-100" data-parent-name="{{ parent_name }}"
    data-parent-id="{{ parent_id }}" data-home-visit-charge="{{ config['HOME_VISIT_CHARGE'] }}">
    <!-- Enhanced Navigation Bar -->
    <nav class="bg-white shadow-xl fixed top-0 left-0 right-0 z-50 border-b border-blue-100">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <a href="{{ url_for('home') }}" class="flex items-center space-x-3 group">
                <div
                    class="bg-gradient-to-r from-blue-600 to-purple-600 w-12 h-12 rounded-2xl flex items-center justify-center shadow-lg">
                    <i class="fas fa-syringe text-white text-xl"></i>
                </div>
                <span
                    class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
                    VACCINE TRACK
                </span>
            </a>

            <div class="hidden md:flex space-x-6 items-center">
                <!-- Enhanced Notification Bell -->
                <div class="relative">
                    <button id="notification-button"
                        class="relative p-2 text-gray-600 hover:text-blue-600 rounded-xl hover:bg-blue-50 transition-all">
                        <i class="fas fa-bell text-xl"></i>
                        <span id="notification-badge"
                            class="hidden absolute -top-1 -right-1 bg-red-500 text-white text-xs w-5 h-5 rounded-full flex items-center justify-center notification-dot border-2 border-white shadow-lg">
                            0
                        </span>
                    </button>
                    <div id="notification-dropdown"
                        class="hidden absolute right-0 mt-2 w-96 bg-white rounded-2xl shadow-2xl z-50 border border-gray-200 overflow-hidden">
                        <div class="gradient-bg p-4 text-white">
                            <h3 class="font-semibold flex items-center">
                                <i class="fas fa-bell mr-2"></i>
                                Notifications
                            </h3>
                        </div>
                        <div id="notification-list" class="max-h-96 overflow-y-auto">
                            <div class="p-6 text-center text-gray-500">
                                <i class="fas fa-bell-slash text-3xl text-gray-300 mb-2"></i>
                                <p>No new notifications</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Enhanced User Menu -->
                <div class="relative">
                    <button id="user-menu-button"
                        class="flex items-center space-x-3 bg-white rounded-2xl px-4 py-2 shadow-sm border border-gray-100 hover:shadow-md transition-all">
                        <div class="relative">
                            <img id="parent-profile-pic-nav"
                                class="h-10 w-10 rounded-2xl object-cover border-2 border-blue-100"
                                src="{{ profile_pic or url_for('static', filename='images/default_avatar.png') }}"
                                alt="Parent Profile">
                            <div
                                class="absolute -bottom-1 -right-1 w-3 h-3 bg-green-400 rounded-full border-2 border-white">
                            </div>
                        </div>
                        <div class="text-left">
                            <span id="user-name" class="font-semibold text-gray-800 block">Loading...</span>
                            <span class="text-xs text-gray-500">Parent</span>
                        </div>
                        <i class="fas fa-chevron-down text-xs text-gray-400"></i>
                    </button>
                    <div id="user-menu"
                        class="hidden absolute right-0 mt-2 w-56 bg-white rounded-2xl shadow-2xl py-2 z-50 border border-gray-200 overflow-hidden">

                        <a href="#settings"
                            class="flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 transition-colors">
                            <i class="fas fa-cog mr-3 text-blue-500"></i>
                            <span>Settings</span>
                        </a>
                        <a href="{{ url_for('chatbot') }}"
                            class="flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-blue-50 transition-colors"
                            target="_blank">
                            <i class="fas fa-question-circle mr-3 text-blue-500"></i>
                            <span>Help & Support</span>
                        </a>
                        <div class="border-t border-gray-100 my-1"></div>
                        <a href="#" id="logout-button"
                            class="flex items-center px-4 py-3 text-sm text-red-600 hover:bg-red-50 transition-colors">
                            <i class="fas fa-sign-out-alt mr-3"></i>
                            <span>Logout</span>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Enhanced Mobile Menu Button -->
            <button id="mobile-menu-button"
                class="md:hidden text-gray-600 hover:text-blue-600 p-2 rounded-lg hover:bg-blue-50 transition-colors">
                <i class="fas fa-bars text-xl"></i>
            </button>
        </div>

        <!-- Enhanced Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white px-4 py-3 border-t border-gray-100">
            <div class="space-y-2">
                <a href="#profile"
                    class="flex items-center py-3 px-4 text-gray-600 hover:bg-blue-50 rounded-lg transition-colors">
                    <i class="fas fa-user mr-3 text-blue-500"></i>
                    Profile & Settings
                </a>
                <a href="#appointments"
                    class="flex items-center py-3 px-4 text-gray-600 hover:bg-blue-50 rounded-lg transition-colors">
                    <i class="fas fa-calendar-alt mr-3 text-blue-500"></i>
                    Appointments
                </a>
                <a href="{{ url_for('chatbot') }}"
                    class="flex items-center py-3 px-4 text-gray-600 hover:bg-blue-50 rounded-lg transition-colors"
                    target="_blank">
                    <i class="fas fa-question-circle mr-3 text-blue-500"></i>
                    Help & Support
                </a>
                <a href="#" id="mobile-logout-button"
                    class="flex items-center py-3 px-4 text-red-600 hover:bg-red-50 rounded-lg transition-colors">
                    <i class="fas fa-sign-out-alt mr-3"></i>
                    Logout
                </a>
            </div>
        </div>
    </nav>

    <!-- Enhanced Dashboard Layout -->
    <div class="dashboard-grid mt-20">
        <!-- Enhanced Sidebar -->
        <div class="sidebar text-white hidden md:block shadow-2xl">
            <div class="p-6">
                <div class="flex items-center space-x-4 mb-8 p-4 glass-effect rounded-2xl">
                    <div class="relative">
                        <img id="parent-profile-pic-sidebar"
                            class="h-14 w-14 rounded-2xl object-cover border-2 border-white/20"
                            src="{{ profile_pic or url_for('static', filename='images/default_avatar.png') }}"
                            alt="Parent Profile">
                        <div
                            class="absolute -bottom-1 -right-1 w-4 h-4 bg-green-400 rounded-full border-2 border-blue-800">
                        </div>
                    </div>
                    <div class="flex-1 min-w-0">
                        <h3 class="font-bold text-white truncate" id="sidebar-user-name">Loading...</h3>
                        <p class="text-blue-200 text-sm">Parent Account</p>
                    </div>
                </div>

                <nav class="space-y-1">
                    <a href="#dashboard"
                        class="flex items-center space-x-4 p-4 rounded-xl bg-white/10 font-semibold backdrop-blur-sm border border-white/10">
                        <i class="fas fa-tachometer-alt w-5 text-center"></i>
                        <span>Dashboard</span>
                    </a>
                    <a href="#profile"
                        class="flex items-center space-x-4 p-4 rounded-xl hover:bg-white/10 transition-all duration-300 border border-transparent hover:border-white/10">
                        <i class="fas fa-user w-5 text-center"></i>
                        <span>Profile</span>
                    </a>
                    <a href="#children"
                        class="flex items-center space-x-4 p-4 rounded-xl hover:bg-white/10 transition-all duration-300 border border-transparent hover:border-white/10">
                        <i class="fas fa-child w-5 text-center"></i>
                        <span>My Children</span>
                    </a>
                    <a href="#appointments"
                        class="flex items-center space-x-4 p-4 rounded-xl hover:bg-white/10 transition-all duration-300 border border-transparent hover:border-white/10">
                        <i class="fas fa-calendar-alt w-5 text-center"></i>
                        <span>Appointments</span>
                    </a>
                    <a href="#calendar"
                        class="flex items-center space-x-4 p-4 rounded-xl hover:bg-white/10 transition-all duration-300 border border-transparent hover:border-white/10">
                        <i class="fas fa-calendar-week w-5 text-center"></i>
                        <span>Calendar</span>
                    </a>
                    <a href="#vaccines"
                        class="flex items-center space-x-4 p-4 rounded-xl hover:bg-white/10 transition-all duration-300 border border-transparent hover:border-white/10">
                        <i class="fas fa-syringe w-5 text-center"></i>
                        <span>Vaccines</span>
                    </a>
                    <a href="#history"
                        class="flex items-center space-x-4 p-4 rounded-xl hover:bg-white/10 transition-all duration-300 border border-transparent hover:border-white/10">
                        <i class="fas fa-history w-5 text-center"></i>
                        <span>Vaccination History</span>
                    </a>
                    
                    <a href="#inbox"
                        class="flex items-center space-x-4 p-4 rounded-xl hover:bg-white/10 transition-all duration-300 border border-transparent hover:border-white/10">
                        <i class="fas fa-inbox w-5 text-center"></i>
                        <span>Inbox</span>
                    </a>
                    <a href="#reminders"
                        class="flex items-center space-x-4 p-4 rounded-xl hover:bg-white/10 transition-all duration-300 border border-transparent hover:border-white/10">
                        <i class="fas fa-bell w-5 text-center"></i>
                        <span>Reminders</span>
                    </a>
                    <a href="{{ url_for('parent_product_store') }}"
                        class="flex items-center space-x-4 p-4 rounded-xl hover:bg-white/10 transition-all duration-300 border border-transparent hover:border-white/10"
                        target="_blank">
                        <i class="fas fa-book-medical w-5 text-center"></i>
                        <span>Store</span>
                    </a>
                    <a href="{{ url_for('parent_order_history') }}"
                        class="flex items-center space-x-4 p-4 rounded-xl hover:bg-white/10 transition-all duration-300 border border-transparent hover:border-white/10">
                        <i class="fas fa-receipt w-5 text-center"></i>
                        <span>Order History</span>
                    </a>
                    <a href="#map-view"
                        class="flex items-center space-x-4 p-4 rounded-xl hover:bg-white/10 transition-all duration-300 border border-transparent hover:border-white/10"
                        id="map-view-link">
                        <i class="fas fa-map-marked-alt w-5 text-center"></i>
                        <span>Nearby Centers</span>
                    </a>
                    <a href="#contact-admin"
                        class="flex items-center space-x-4 p-4 rounded-xl hover:bg-white/10 transition-all duration-300 border border-transparent hover:border-white/10">
                        <i class="fas fa-headset w-5 text-center"></i>
                        <span>Contact Admin</span>
                    </a>
                </nav>
            </div>
        </div>

        <!-- Enhanced Main Content -->
        <main class="p-6 overflow-auto">
            <!-- Welcome Section -->
            <section id="dashboard" class="mb-8">
                <div class="gradient-bg rounded-2xl p-8 text-white shadow-xl relative overflow-hidden">
                    <div class="relative z-10">
                        <h1 class="text-4xl font-bold mb-3" id="welcome-message">Welcome back! ðŸ‘‹</h1>
                        <p class="text-blue-100 text-lg">Here's your child's vaccination overview and upcoming schedule
                        </p>
                    </div>
                    <div
                        class="absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-32 translate-x-32">
                    </div>
                    <div
                        class="absolute bottom-0 left-0 w-48 h-48 bg-white/5 rounded-full translate-y-24 -translate-x-24">
                    </div>
                </div>
            </section>

            <!-- Enhanced Stats Cards -->
            <section class="mb-8">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6" id="stats-cards">
                    <div class="bg-white rounded-2xl p-6 shadow-lg card-hover stat-card border border-gray-100">
                        <div class="text-center">
                            <div
                                class="bg-blue-100 w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-child text-blue-600 text-2xl"></i>
                            </div>
                            <div id="total-children-stat" class="text-3xl font-bold text-blue-600 mb-2">
                                <span class="animate-pulse bg-gray-200 rounded-lg inline-block w-16 h-8"></span>
                            </div>
                            <div class="text-gray-600 font-medium">Total Children</div>
                        </div>
                    </div>
                    <div class="bg-white rounded-2xl p-6 shadow-lg card-hover stat-card border border-gray-100">
                        <div class="text-center">
                            <div
                                class="bg-green-100 w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-syringe text-green-600 text-2xl"></i>
                            </div>
                            <div id="upcoming-vaccines-stat" class="text-3xl font-bold text-green-600 mb-2">
                                <span class="animate-pulse bg-gray-200 rounded-lg inline-block w-16 h-8"></span>
                            </div>
                            <div class="text-gray-600 font-medium">Upcoming Vaccines</div>
                        </div>
                    </div>
                    <div class="bg-white rounded-2xl p-6 shadow-lg card-hover stat-card border border-gray-100">
                        <div class="text-center">
                            <div
                                class="bg-purple-100 w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-calendar-check text-purple-600 text-2xl"></i>
                            </div>
                            <div id="total-appointments-stat" class="text-3xl font-bold text-purple-600 mb-2">
                                <span class="animate-pulse bg-gray-200 rounded-lg inline-block w-16 h-8"></span>
                            </div>
                            <div class="text-gray-600 font-medium">Appointments</div>
                        </div>
                    </div>
                    <div class="bg-white rounded-2xl p-6 shadow-lg card-hover stat-card border border-gray-100">
                        <div class="text-center">
                            <div
                                class="bg-orange-100 w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4">
                                <i class="fas fa-check-circle text-orange-600 text-2xl"></i>
                            </div>
                            <div id="completed-vaccines-stat" class="text-3xl font-bold text-orange-600 mb-2">
                                <span class="animate-pulse bg-gray-200 rounded-lg inline-block w-16 h-8"></span>
                            </div>
                            <div class="text-gray-600 font-medium">Completed Vaccines</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Enhanced Children Section -->
            <section id="children" class="mb-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-800 flex items-center">
                        <i class="fas fa-child text-blue-600 mr-3"></i>
                        My Children
                    </h2>
                    <div class="flex items-center space-x-3">
                        <button id="view-all-children-button"
                            class="bg-gray-100 text-gray-700 px-4 py-2 rounded-xl hover:bg-gray-200 transition-all font-medium">
                            View All
                        </button>
                        <button id="add-child-button"
                            class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-5 py-2 rounded-xl hover:shadow-lg transition-all font-semibold flex items-center">
                            <i class="fas fa-plus mr-2"></i>Add Child
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="children-list">
                    {% if children %}
                    {% for child in children %}
                    <div class="bg-white rounded-2xl p-6 shadow-lg border border-gray-100 card-hover child-card"
                        data-child-id="{{ child.id }}">
                        <div class="flex items-start space-x-4">
                            <img src="{{ child.profile_pic or url_for('static', filename='images/default_child_avatar.png') }}"
                                alt="{{ child.name }}'s profile"
                                class="w-16 h-16 rounded-2xl object-cover border-2 border-blue-100">
                            <div class="flex-1">
                                <div class="flex justify-between items-center">
                                    <h3 class="text-lg font-bold text-gray-800">{{ child.name }}</h3>
                                    <span
                                        class="text-xs font-semibold px-2 py-1 rounded-full {{ 'bg-blue-100 text-blue-800' if child.gender == 'Male' else 'bg-pink-100 text-pink-800' }}">{{
                                        child.gender }}</span>
                                </div>
                                <p class="text-sm text-gray-500">Age: {{ child.age }}</p>
                                <div class="mt-3 pt-3 border-t border-gray-100">
                                    <p class="text-xs text-gray-600"><strong>Next Vaccine:</strong>
                                        <span class="font-semibold text-green-600">{{ child.next_vaccine_name or 'Up to
                                            date' }}</span>
                                    </p>
                                    <p class="text-xs text-gray-500">Due: {{ child.next_vaccine_date or 'N/A' }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                    {% else %}
                    <div class="md:col-span-2 bg-white rounded-2xl p-8 shadow-lg border border-gray-100 text-center">
                        <div class="flex flex-col items-center">
                            <i class="fas fa-baby text-4xl text-gray-300 mb-4"></i>
                            <h3 class="text-lg font-semibold text-gray-700">No Children Added Yet</h3>
                            <p class="text-gray-500 mt-1 mb-4">Click the "Add Child" button to get started.</p>
                            <button id="add-child-from-empty-state-button"
                                class="bg-gradient-to-r from-blue-600 to-purple-600 text-white px-5 py-2 rounded-xl hover:shadow-lg transition-all font-semibold flex items-center">
                                <i class="fas fa-plus mr-2"></i>Add Your First Child
                            </button>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </section>

            <!-- Enhanced Missed Appointments Section -->
            <section id="missed-appointments-section" class="mb-8 hidden">
                <div
                    class="bg-gradient-to-r from-red-50 to-orange-50 border-l-4 border-red-500 rounded-2xl p-6 shadow-lg">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold text-red-800 flex items-center">
                            <i class="fas fa-exclamation-triangle mr-3"></i>Missed Appointments
                        </h2>
                    </div>
                    <p class="text-sm text-red-700 mb-4">You have some appointments that were missed. Please reschedule
                        them as soon as possible.</p>
                    <div class="space-y-4" id="missed-appointments-list">
                        <!-- Missed appointments will be loaded dynamically -->
                    </div>
                </div>
            </section>

            <!-- Enhanced Upcoming Vaccines & Appointments -->
            <section id="appointments" class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Upcoming Vaccines -->
                <div class="bg-white rounded-2xl p-6 shadow-lg border border-gray-100">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-syringe text-green-600 mr-3"></i>
                        Upcoming Vaccines
                    </h2>
                    <div class="space-y-4" id="upcoming-vaccines">
                        <div class="animate-pulse">
                            <div class="h-16 bg-gray-200 rounded-xl"></div>
                        </div>
                    </div>
                    <a href="#history"
                        class="w-full mt-6 text-center text-blue-600 hover:text-blue-800 font-semibold block py-3 border-t border-gray-100">
                        View All Vaccines <i class="fas fa-chevron-right ml-1"></i>
                    </a>
                </div>

                <!-- Appointments -->
                <div class="bg-white rounded-2xl p-6 shadow-lg border border-gray-100">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-xl font-bold text-gray-800 flex items-center">
                            <i class="fas fa-calendar-alt text-purple-600 mr-3"></i>
                            My Appointments
                        </h2>
                        <button id="book-appointment-button"
                            class="bg-gradient-to-r from-green-600 to-emerald-600 text-white px-4 py-2 rounded-xl hover:shadow-lg text-sm font-semibold transition-all">
                            <i class="fas fa-plus mr-1"></i> Book New
                        </button>
                    </div>
                    <div class="space-y-4" id="appointments-list">
                        <div class="animate-pulse">
                            <div class="h-16 bg-gray-200 rounded-xl"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Enhanced Vaccine Schedule Section -->
            <section id="vaccine-schedule" class="mb-8">
                <div class="bg-white rounded-2xl p-6 shadow-lg border border-gray-100">
                    <h2 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fas fa-clock text-orange-600 mr-3"></i>
                        Vaccine Schedule (Due)
                    </h2>
                    <p class="text-sm text-gray-500 mb-4">This list shows recommended vaccines that are due for your
                        children based on their age and have not been completed or scheduled yet.</p>
                    <div class="space-y-4" id="vaccine-schedule-list">
                        <div class="animate-pulse">
                            <div class="h-16 bg-gray-200 rounded-xl"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Enhanced Vaccination History -->
            <section id="history" class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-history text-blue-600 mr-3"></i>
                    Vaccination History
                </h2>
                <div class="bg-white rounded-2xl shadow-lg border border-gray-100 overflow-hidden">
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gradient-to-r from-gray-50 to-blue-50">
                                <tr>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Vaccine</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Child</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Date</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Status</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Administered By</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Price</th>
                                    <th
                                        class="px-6 py-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                        Actions</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-100" id="vaccination-history-body">
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="animate-pulse">
                                            <div class="h-4 bg-gray-200 rounded w-24"></div>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="animate-pulse">
                                            <div class="h-4 bg-gray-200 rounded w-16"></div>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="animate-pulse">
                                            <div class="h-4 bg-gray-200 rounded w-20"></div>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="animate-pulse">
                                            <div class="h-6 bg-gray-200 rounded w-16"></div>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="animate-pulse">
                                            <div class="h-8 bg-gray-200 rounded w-20"></div>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- Enhanced Map View Section -->
            <section id="map-view" class="p-6 overflow-auto hidden">
                <h1 class="text-3xl font-bold text-gray-800 mb-4 flex items-center">
                    <i class="fas fa-map-marked-alt text-green-600 mr-3"></i>
                    Nearby Vaccination Centers
                </h1>
                <p class="text-gray-600 mb-6">Explore vaccination centers where our registered doctors practice.</p>
                <div id="mapid" class="w-full h-[600px] rounded-2xl shadow-lg bg-gray-200 border border-gray-300">
                    <!-- Map will be initialized here by Leaflet.js -->
                </div>
                <div class="mt-6 p-6 bg-white rounded-2xl shadow-lg border border-gray-100">
                    <h3 class="font-semibold text-gray-800 mb-3 flex items-center">
                        <i class="fas fa-info-circle text-blue-600 mr-2"></i>
                        Map Legend
                    </h3>
                    <div class="flex items-center">
                        <img src="/static/images/hospital_marker.png" alt="Hospital Icon" class="w-8 h-8 mr-3">
                        <span class="text-gray-700 font-medium">Registered Hospital/Clinic</span>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Enhanced Book Appointment Modal -->
    <div id="book-appointment-modal"
        class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden backdrop-blur-sm">
        <div
            class="bg-white rounded-2xl w-full max-w-md mx-4 flex flex-col max-h-[90vh] shadow-2xl border border-gray-200">
            <div class="flex justify-between items-center p-6 border-b border-gray-100">
                <h3 class="text-xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-calendar-plus text-blue-600 mr-3"></i>
                    Book New Appointment
                </h3>
                <button id="close-appointment-modal"
                    class="text-gray-400 hover:text-gray-600 p-2 -mr-2 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="book-appointment-form" class="flex-grow overflow-y-auto">
                <div class="p-6 space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Select Child</label>
                        <select name="child_id" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                            id="appointment-child-select">
                            <option value="" selected>Select Child</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Select Vaccine</label>
                        <select name="vaccine_id" required id="appointment-vaccine-select"
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                            <option value="" selected>Select Vaccine</option>
                        </select>
                    </div>
                    <!-- State and City Filters -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="appointment-state-filter" class="block text-sm font-medium text-gray-700 mb-2">State</label>
                            <select id="appointment-state-filter" name="state" class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                <option value="">Select State</option>
                            </select>
                        </div>
                        <div>
                            <label for="appointment-city-filter" class="block text-sm font-medium text-gray-700 mb-2">City</label>
                            <select id="appointment-city-filter" name="city" disabled class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all bg-gray-100 cursor-not-allowed">
                                <option value="">Select City</option>
                            </select>
                        </div>
                    </div>

                    <!-- Doctor Selection Section -->
                    <div id="appointment-doctor-section" class="pt-4 border-t">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Select a Doctor</label>
                        <input type="hidden" name="doctor_id" id="appointment-doctor-id">
                        <div id="selected-doctor-name" class="p-3 bg-blue-50 border border-blue-200 rounded-lg text-blue-800 font-semibold hidden mb-4"></div>
                        <div id="appointment-doctor-list-container" class="max-h-64 overflow-y-auto p-1 bg-gray-50 rounded-lg">
                            <p class="text-center text-gray-500 p-4">Please select a city to see available doctors.</p>
                        </select>
                    </div>
                    <div class="mt-6">
                        <label class="block text-sm font-medium text-gray-700 mb-3">Service Type</label>
                        <div class="grid grid-cols-2 gap-3 mb-6">
                            <label
                                class="flex items-center p-4 border-2 border-gray-200 rounded-xl cursor-pointer hover:border-blue-500 transition-all has-[:checked]:border-blue-500 has-[:checked]:bg-blue-50">
                                <input type="radio" name="service_type" value="Center"
                                    class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300" checked>
                                <span class="ml-3 text-sm font-medium text-gray-700 flex items-center">
                                    <i class="fas fa-hospital-alt mr-2 text-blue-600"></i>Center
                                </span>
                            </label>
                            <label
                                class="flex items-center p-4 border-2 border-gray-200 rounded-xl cursor-pointer hover:border-green-500 transition-all has-[:checked]:border-green-500 has-[:checked]:bg-green-50">
                                <input type="radio" name="service_type" value="Home"
                                    class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300">
                                <span class="ml-3 text-sm font-medium text-gray-700 flex items-center">
                                    <i class="fas fa-home mr-2 text-green-600"></i>Home
                                </span>
                            </label>
                        </div>
                    </div>
                    <div id="payment-method-section" class="mt-6">
                        <label id="payment-method-label" class="block text-sm font-medium text-gray-700 mb-3">Payment
                            Method</label>
                        <div class="grid grid-cols-2 gap-3">
                            <label
                                class="flex items-center p-4 border-2 border-gray-200 rounded-xl cursor-pointer hover:border-blue-500 transition-all has-[:checked]:border-blue-500 has-[:checked]:bg-blue-50">
                                <input type="radio" name="payment_method" value="Cash"
                                    class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300" checked>
                                <span class="ml-3 text-sm font-medium text-gray-700 flex items-center">
                                    <i class="fas fa-money-bill-wave mr-2 text-blue-600"></i>Cash
                                </span>
                            </label>
                            <label
                                class="flex items-center p-4 border-2 border-gray-200 rounded-xl cursor-pointer hover:border-purple-500 transition-all has-[:checked]:border-purple-500 has-[:checked]:bg-purple-50">
                                <input type="radio" name="payment_method" value="online"
                                    class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300">
                                <span class="ml-3 text-sm font-medium text-gray-700 flex items-center">
                                    <i class="fab fa-google-pay mr-2 text-purple-600"></i>UPI
                                </span>
                            </label>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2 mt-5">Preferred Date</label>
                        <input type="date" name="preferred_date" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2 mt-5">Preferred Time</label>
                        <select name="preferred_time" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                            <option value="">Select Time</option>
                            <option value="09:00">09:00 AM</option>
                            <option value="10:00">10:00 AM</option>
                            <option value="11:00">11:00 AM</option>
                            <option value="12:00">12:00 PM</option>
                            <option value="14:00">02:00 PM</option>
                            <option value="15:00">03:00 PM</option>
                            <option value="16:00">04:00 PM</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2 mt-5">Notes (Optional)</label>
                        <textarea name="notes" rows="2"
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                            placeholder="Any additional notes..."></textarea>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 p-6 border-t border-gray-100 bg-gray-50 rounded-b-2xl">
                    <button type="button" id="cancel-appointment"
                        class="px-6 py-3 text-gray-600 border border-gray-300 rounded-xl hover:bg-gray-100 transition-all font-medium">Cancel</button>
                    <button type="submit"
                        class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:shadow-lg transition-all font-semibold">
                        <i class="fas fa-calendar-check mr-2"></i>Book Appointment
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Child Details Modal -->
    <div id="child-details-modal"
        class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden backdrop-blur-sm">
        <div
            class="bg-white rounded-2xl p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto shadow-2xl border border-gray-200">
            <div class="flex justify-between items-center mb-6 sticky top-0 bg-white py-4 border-b border-gray-100">
                <h3 class="text-2xl font-bold text-gray-800 flex items-center" id="child-modal-title">
                    <i class="fas fa-child text-blue-500 mr-3"></i>
                    Child Details
                </h3>
                <button id="close-child-modal" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="child-modal-content" class="space-y-6">
                <!-- Basic Info Section -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 items-center">
                    <div class="md:col-span-1 flex justify-center">
                        <img id="child-modal-pic" src="" alt="Child's profile"
                            class="w-32 h-32 rounded-full object-cover border-4 border-blue-200 shadow-lg">
                    </div>
                    <div class="md:col-span-2 grid grid-cols-2 gap-x-6 gap-y-4">
                        <div>
                            <p class="text-sm text-gray-500">Name</p>
                            <p id="child-modal-name" class="font-bold text-lg text-gray-800"></p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Age</p>
                            <p id="child-modal-age" class="font-semibold text-gray-700"></p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Gender</p>
                            <p id="child-modal-gender" class="font-semibold text-gray-700"></p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Date of Birth</p>
                            <p id="child-modal-dob" class="font-semibold text-gray-700"></p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Blood Group</p>
                            <p id="child-modal-blood-group" class="font-semibold text-gray-700"></p>
                        </div>
                        <div>
                            <p class="text-sm text-gray-500">Birth Weight</p>
                            <p id="child-modal-birth-weight" class="font-semibold text-gray-700"></p>
                        </div>
                    </div>
                </div>

                <!-- Vaccination Status Section -->
                <div>
                    <h4 class="text-lg font-semibold text-gray-800 mb-3 border-t pt-4">Vaccination Status</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-green-50 p-4 rounded-xl border border-green-200">
                            <p class="text-sm text-green-700">Next Due Vaccine</p>
                            <p id="child-modal-next-vaccine" class="font-bold text-green-800"></p>
                            <p id="child-modal-next-vaccine-date" class="text-xs text-green-600"></p>
                        </div>
                        <div class="bg-red-50 p-4 rounded-xl border border-red-200">
                            <p class="text-sm text-red-700">Missed/Overdue</p>
                            <p id="child-modal-missed-vaccines" class="font-bold text-red-800"></p>
                        </div>
                    </div>
                </div>

                <!-- Growth Chart Section -->
                <div>
                    <h4 class="text-lg font-semibold text-gray-800 mb-3 border-t pt-4">Growth Chart</h4>
                    <div class="bg-gray-50 p-4 rounded-xl border border-gray-200">
                        <canvas id="child-growth-chart"></canvas>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex justify-center space-x-4 border-t pt-6">
                    <button id="edit-child-details-btn"
                        class="bg-yellow-500 text-white px-5 py-2 rounded-lg font-semibold hover:bg-yellow-600 transition-all"><i
                            class="fas fa-edit mr-2"></i>Edit Details</button>
                    <button id="delete-child-btn"
                        class="bg-red-600 text-white px-5 py-2 rounded-lg font-semibold hover:bg-red-700 transition-all"><i
                            class="fas fa-trash-alt mr-2"></i>Delete Child</button>
                </div>
            </div>
            <div class="flex justify-end mt-8 pt-6 border-t border-gray-100">
                <button type="button" id="ok-child-modal"
                    class="px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:shadow-lg transition-all font-semibold">
                    <i class="fas fa-check mr-2"></i>
                    OK
                </button>
            </div>
        </div>
    </div>

    <!-- Add Child Modal -->
    <div id="add-child-modal"
        class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden backdrop-blur-sm">
        <div
            class="bg-white rounded-2xl w-full max-w-lg mx-4 flex flex-col max-h-[90vh] shadow-2xl border border-gray-200">
            <div class="flex justify-between items-center p-6 border-b border-gray-100">
                <h3 class="text-xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-plus-circle text-blue-600 mr-3"></i>
                    Add a New Child
                </h3>
                <button id="close-add-child-modal"
                    class="text-gray-400 hover:text-gray-600 p-2 -mr-2 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="add-child-form" class="flex-grow overflow-y-auto">
                <div class="p-6 space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Child's Full Name</label>
                        <input type="text" name="name" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                            placeholder="e.g., Aryan Sharma">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Date of Birth</label>
                            <input type="date" name="birth_date" required
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Gender</label>
                            <select name="gender" required
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                <option value="">Select Gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Birth Weight (kg)</label>
                            <input type="number" step="0.01" name="birth_weight"
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                                placeholder="e.g., 3.1">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Blood Group</label>
                            <select name="blood_group"
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                <option value="">Select Blood Group</option>
                                <option value="A+">A+</option>
                                <option value="A-">A-</option>
                                <option value="B+">B+</option>
                                <option value="B-">B-</option>
                                <option value="AB+">AB+</option>
                                <option value="AB-">AB-</option>
                                <option value="O+">O+</option>
                                <option value="O-">O-</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Known Allergies (Optional)</label>
                        <textarea name="allergies" rows="2"
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                            placeholder="e.g., Penicillin, Peanuts"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Medical Notes (Optional)</label>
                        <textarea name="medical_notes" rows="2"
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                            placeholder="Any other important medical information..."></textarea>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 p-6 border-t border-gray-100 bg-gray-50 rounded-b-2xl">
                    <button type="button" id="cancel-add-child"
                        class="px-6 py-3 text-gray-600 border border-gray-300 rounded-xl hover:bg-gray-100 transition-all font-medium">Cancel</button>
                    <button type="submit"
                        class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:shadow-lg transition-all font-semibold">
                        <i class="fas fa-plus mr-2"></i>Add Child
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Child Modal -->
    <div id="edit-child-modal"
        class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden backdrop-blur-sm">
        <div
            class="bg-white rounded-2xl w-full max-w-lg mx-4 flex flex-col max-h-[90vh] shadow-2xl border border-gray-200">
            <div class="flex justify-between items-center p-6 border-b border-gray-100">
                <h3 class="text-xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-edit text-blue-600 mr-3"></i>
                    Edit Child Information
                </h3>
                <button id="close-edit-child-modal"
                    class="text-gray-400 hover:text-gray-600 p-2 -mr-2 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="edit-child-form" class="flex-grow overflow-y-auto">
                <input type="hidden" id="edit-child-id" name="child_id">
                <div class="p-6 space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Child's Full Name</label>
                        <input type="text" id="edit-child-name" name="name" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Date of Birth</label>
                            <input type="date" id="edit-child-birth-date" name="birth_date" required
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Gender</label>
                            <select id="edit-child-gender" name="gender" required
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Birth Weight (kg)</label>
                            <input type="number" step="0.01" id="edit-child-birth-weight" name="birth_weight"
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Blood Group</label>
                            <select id="edit-child-blood-group" name="blood_group"
                                class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                                <option value="">Select Blood Group</option>
                                <option value="A+">A+</option>
                                <option value="A-">A-</option>
                                <option value="B+">B+</option>
                                <option value="B-">B-</option>
                                <option value="AB+">AB+</option>
                                <option value="AB-">AB-</option>
                                <option value="O+">O+</option>
                                <option value="O-">O-</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Known Allergies (Optional)</label>
                        <textarea id="edit-child-allergies" name="allergies" rows="2"
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"></textarea>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Medical Notes (Optional)</label>
                        <textarea id="edit-child-medical-notes" name="medical_notes" rows="2"
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"></textarea>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 p-6 border-t border-gray-100 bg-gray-50 rounded-b-2xl">
                    <button type="button" id="cancel-edit-child"
                        class="px-6 py-3 text-gray-600 border border-gray-300 rounded-xl hover:bg-gray-100 transition-all font-medium">Cancel</button>
                    <button type="submit"
                        class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:shadow-lg transition-all font-semibold">
                        <i class="fas fa-save mr-2"></i>Save Changes
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- View Child Details Modal -->
    <div id="view-child-modal"
        class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden backdrop-blur-sm">
        <div
            class="bg-white rounded-2xl p-6 w-full max-w-xl mx-4 max-h-[90vh] overflow-y-auto shadow-2xl border border-gray-200">
            <div class="flex justify-between items-center mb-6 sticky top-0 bg-white py-4 border-b border-gray-100">
                <h3 class="text-2xl font-bold text-gray-800 flex items-center" id="view-child-name-title">
                    <i class="fas fa-child text-blue-500 mr-3"></i>
                    Child Details
                </h3>
                <button id="close-view-child-modal" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="view-child-content" class="space-y-6">
                <!-- Content will be populated by JS -->
            </div>
            <div class="flex justify-end mt-8 pt-6 border-t border-gray-100">
                <button type="button" id="ok-view-child"
                    class="px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:shadow-lg transition-all font-semibold">
                    <i class="fas fa-check mr-2"></i>
                    OK
                </button>
            </div>
        </div>
    </div>

    <!-- Doctor Review Modal -->
    <div id="review-modal"
        class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden backdrop-blur-sm">
        <div
            class="bg-white rounded-2xl w-full max-w-lg mx-4 flex flex-col max-h-[90vh] shadow-2xl border border-gray-200">
            <div id="review-modal-header" class="flex justify-between items-center p-6 border-b border-gray-100">
                <h3 class="text-xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-star text-yellow-500 mr-3"></i>
                    <span id="review-modal-title">Leave a Review</span>
                </h3>
                <button id="close-review-modal" class="text-gray-400 hover:text-gray-600 p-2 -mr-2 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="review-form" class="flex-grow overflow-y-auto">
                <input type="hidden" id="review-appointment-id">
                <input type="hidden" id="review-doctor-id">
                <div class="p-6 space-y-6">
                    <div class="text-center">
                        <p class="text-gray-600">Reviewing your experience for:</p>
                        <p class="font-semibold text-lg text-blue-600" id="review-appointment-details">Vaccine on Date
                        </p>
                        <p class="text-sm text-gray-500">with <strong id="review-doctor-name"></strong></p>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2 text-center">Your Rating</label>
                        <div id="star-rating" class="flex justify-center text-4xl text-gray-300 cursor-pointer">
                            <i class="fas fa-star" data-value="1"></i>
                            <i class="fas fa-star" data-value="2"></i>
                            <i class="fas fa-star" data-value="3"></i>
                            <i class="fas fa-star" data-value="4"></i>
                            <i class="fas fa-star" data-value="5"></i>
                        </div>
                        <input type="hidden" id="rating-value" name="rating" required>
                    </div>

                    <div>
                        <label for="review-text" class="block text-sm font-medium text-gray-700 mb-2">Your Review
                            (Optional)</label>
                        <textarea id="review-text" name="review_text" rows="4"
                            class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                            placeholder="Share details of your own experience at this appointment..."></textarea>
                    </div>

                    <div class="flex items-center">
                        <input id="is-anonymous" name="is_anonymous" type="checkbox"
                            class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                        <label for="is-anonymous" class="ml-2 block text-sm text-gray-900">
                            Submit review anonymously
                        </label>
                    </div>
                </div>
                <div class="flex justify-end space-x-3 p-6 border-t border-gray-100 bg-gray-50 rounded-b-2xl">
                    <button type="button" id="cancel-review-button"
                        class="px-6 py-3 text-gray-600 border border-gray-300 rounded-xl hover:bg-gray-100 transition-all font-medium">Cancel</button>
                    <button type="submit"
                        class="px-6 py-3 bg-gradient-to-r from-yellow-500 to-orange-500 text-white rounded-xl hover:shadow-lg transition-all font-semibold">
                        <i class="fas fa-paper-plane mr-2"></i>Submit Review
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Enhanced Success/Error Toast -->
    <div id="toast-container" class="fixed top-24 right-6 z-[100] space-y-2"></div>

    <!-- Enhanced Loading Spinner -->
    <div id="loading-spinner"
        class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[110] hidden backdrop-blur-sm">
        <div class="bg-white rounded-2xl p-8 shadow-2xl flex flex-col items-center">
            <div class="w-16 h-16 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mb-4"></div>
            <span class="text-gray-700 font-semibold">Loading...</span>
        </div>
    </div>

    <!-- Enhanced Back to Top Button -->
    <button id="back-to-top"
        class="fixed bottom-8 right-8 bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 rounded-2xl shadow-2xl hover:shadow-3xl transition-all duration-300 z-50 hidden transform hover:scale-110"
        title="Go to top">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"
            stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M5 15l7-7 7 7" />
        </svg>
    </button>

    <!-- Chatbot Button -->
    <a href="{{ url_for('chatbot', user_id=parent_id, user_role='parent') }}" target="_blank" rel="noopener noreferrer"
        class="fixed bottom-8 right-8 bg-blue-600 text-white p-4 rounded-full shadow-lg hover:bg-blue-700 transition-all duration-300 z-50"
        title="Chat with our Assistant">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor"
            stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round"
                d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z" />
        </svg>
    </a>

    <div id="toast"
        class="fixed top-24 right-6 bg-gradient-to-r from-green-500 to-emerald-600 text-white px-6 py-4 rounded-xl shadow-2xl z-[100] transform translate-x-[120%] transition-transform duration-300 border-l-4 border-white/30">
        <div class="flex items-center space-x-3">
            <i id="toast-icon" class="fas fa-check-circle text-lg"></i>
            <span id="toast-message" class="font-semibold">Operation completed successfully!</span>
        </div>
    </div>

    <!-- Home Visit Details Modal -->
    <div id="home-visit-modal"
        class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 hidden">
        <div class="relative top-20 mx-auto p-5 border w-full max-w-2xl shadow-lg rounded-md bg-white">
            <div class="flex justify-between items-center border-b pb-3">
                <h3 class="text-lg font-medium text-gray-900">Home Visit Details</h3>
                <button onclick="hideModal('home-visit-modal')" class="text-gray-400 hover:text-gray-600">
                    <span class="text-2xl">&times;</span>
                </button>
            </div>
            <div class="mt-4" id="home-visit-content">
                <!-- Details will be loaded here by JavaScript -->
                <p>Loading details...</p>
            </div>
            <div class="mt-6 text-right">
                <button onclick="hideModal('home-visit-modal')"
                    class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300">Close</button>
            </div>
        </div>
    </div>

    <!-- Manage Growth Records Modal -->
    <div id="manage-growth-records-modal"
        class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden backdrop-blur-sm">
        <div
            class="bg-white rounded-2xl w-full max-w-2xl mx-4 flex flex-col max-h-[90vh] shadow-2xl border border-gray-200">
            <div class="flex justify-between items-center p-6 border-b border-gray-100 sticky top-0 bg-white z-10">
                <h3 class="text-xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-chart-line text-blue-600 mr-3"></i>
                    Growth Records for <span id="manage-growth-child-name" class="ml-2 text-blue-600"></span>
                </h3>
                <button onclick="hideModal('manage-growth-records-modal')"
                    class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="growth-records-list-container" class="flex-grow overflow-y-auto p-6">
                <!-- Growth records table will be populated here -->
            </div>
            <div class="flex justify-end p-6 border-t border-gray-100 bg-gray-50 sticky bottom-0">
                <button type="button" onclick="hideModal('manage-growth-records-modal')"
                    class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:shadow-lg transition-all font-semibold">
                    <i class="fas fa-check mr-2"></i>Close
                </button>
            </div>
        </div>
    </div>

    <!-- Add Growth Record Modal -->
    <div id="add-growth-record-modal"
        class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden backdrop-blur-sm">
        <div
            class="bg-white rounded-2xl w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto shadow-2xl border border-gray-200">
            <div class="flex justify-between items-center p-6 border-b border-gray-100 sticky top-0 bg-white z-10">
                <h3 class="text-xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-chart-line text-blue-600 mr-3"></i>
                    Add Growth Record
                </h3>
                <button id="close-growth-modal" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="add-growth-record-form" class="p-6 space-y-4">
                <input type="hidden" id="growth-child-id">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Record Date</label>
                    <input type="date" id="growth-record-date" required
                        class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Weight (kg)</label>
                    <input type="number" step="0.1" id="growth-weight" required
                        class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                        placeholder="e.g., 5.2">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Height (cm)</label>
                    <input type="number" step="0.1" id="growth-height" required
                        class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"
                        placeholder="e.g., 55.5">
                </div>
                <div class="flex justify-end space-x-3 pt-4 border-t border-gray-100">
                    <button type="button" id="cancel-growth-record"
                        class="px-6 py-3 text-gray-600 border border-gray-300 rounded-xl hover:bg-gray-100 transition-all font-medium">Cancel</button>
                    <button type="submit"
                        class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:shadow-lg transition-all font-semibold">
                        <i class="fas fa-save mr-2"></i>Save Record
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Edit Growth Record Modal -->
    <div id="edit-growth-record-modal"
        class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 hidden backdrop-blur-sm">
        <div
            class="bg-white rounded-2xl w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto shadow-2xl border border-gray-200">
            <div class="flex justify-between items-center p-6 border-b border-gray-100 sticky top-0 bg-white z-10">
                <h3 class="text-xl font-bold text-gray-800 flex items-center">
                    <i class="fas fa-edit text-green-600 mr-3"></i>
                    Edit Growth Record
                </h3>
                <button onclick="hideModal('edit-growth-record-modal')"
                    class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="edit-growth-record-form" class="p-6 space-y-4">
                <input type="hidden" id="edit-growth-record-id">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Record Date</label>
                    <input type="date" id="edit-record-date" required
                        class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Weight (kg)</label>
                    <input type="number" step="0.1" id="edit-weight" required
                        class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">Height (cm)</label>
                    <input type="number" step="0.1" id="edit-height" required
                        class="w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all">
                </div>
                <div class="flex justify-end space-x-3 pt-4 border-t border-gray-100">
                    <button type="button" onclick="hideModal('edit-growth-record-modal')"
                        class="px-6 py-3 text-gray-600 border border-gray-300 rounded-xl hover:bg-gray-100 transition-all font-medium">Cancel</button>
                    <button type="submit"
                        class="px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:shadow-lg transition-all font-semibold">
                        <i class="fas fa-save mr-2"></i>Update Record
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Leaflet JS for Map View -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="{{ url_for('static', filename='JS/Users/Parent/parentDashboard.js') }}"></script>
</body>

</html>